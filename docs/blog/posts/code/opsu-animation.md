---
date:
  created: 2024-06-22
tags:
  - java
  - game
  - coding
  - animation
  - osu!
  - WIP
categories:
  - Coding
comments: true
---

# opsu! 开发 - 定制动画

最近正在忙着研究 opsu! 的源码，并在其上做一些更改与优化。其中值得关注的一个点就是：**界面动画**。<!-- more -->

原仓库版本中，从主界面到按钮菜单的转场显得比较生硬：点击按钮之后，一大批按钮的菜单突然闪现，主打一个措手不及；游玩过程中，连击提示图以一种*线性*的方式向中间滑出，然后才渐隐，有些过于不自然了。

理想情况下，我们需要的是像 osu! 一样丝滑的小动画：界面变暗，按钮渐隐渐现；提示人物优雅滑出，慢慢隐藏。

下面的问题就在于，从理想到现实，该如何做。

## 控制机制

我花了一点时间搜索文件，研究 opsu! 中动画的控制机制。

在 opsu! 中（多数其他游戏也应相同），对象的动画是由**函数**与**表达式**控制的，它们负责：

- 计算元素的 X / Y 坐标值
- 控制元素大小、透明度、旋转（如果有）
- 如有可能，裁剪元素
- 函数以时间变化量（即 *Delta*）作为其一参数，更新元素状态
